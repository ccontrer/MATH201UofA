% MATH 201 Lab notes (c) by Carlos Contreras And Philippe Gaudreau
% MATH 201 Lab notes is licensed under a 
% Creative Commons Attribution 4.0 International license.
% CC BY 4.0

% You should have received a copy of the license along with this
% work. If not, see <http://creativecommons.org/licenses/by/4.0/>.

\documentclass[11pt]{article}
\input{labs-style.tex}
\usepackage{hyperref}
\usepackage{cancel}
\usepackage{mathtools}


\begin{document}
\course{Differential Equations}
\coursecode{MATH 201}
\term{Winter 2018}
\instructor{Carlos Contreras}
\lqnumber{Lab 9}
\labtitle{LT-- Convolution theorem}
\makelabtitle


\begin{problem}
Find the integral
\[\int_{0}^{\infty}t\sin (2t) e^{-2t}dt\]
\end{problem}


\topic{Periodic functions}

\begin{problem}
Find the Laplace transform of the periodic function
\[f(t)=\left\{\begin{array}{ll}
        e^{-t}\,, & 0<t<1\,,\\
        1\,, & 1<t<2\,,
       \end{array}\right.
\]
with period $T=2$.
\end{problem}


\topic{Convolution theorem}


\begin{problem}
Use the convolution theorem to obtain to find the inverse Laplace transform of the given function
\begin{equation*}
F(s) = \dfrac{1}{s^2 (s^2+9)}.
\end{equation*}
\end{problem}





\begin{problem}
Use the convolution theorem to obtain a formula for the solution to the given initial value problem, where $g(t)$ is piecewise continuous on $[0,\infty)$ and of exponential order.
\begin{equation*}
y^{\prime \prime} + 4y^{\prime} + 5 y = g(t), \quad y(0)=1, \quad y^{\prime}(0)=1.
\end{equation*}
\end{problem}


\topic{Integro-differential equations}

\begin{problem}
Solve the integro--differential equation
\[y'-2\int_{0}^{t}e^{t-v}y(v)dv=t,\quad y(0)=2.\]
\end{problem}


\topic{System of differential equations}

\begin{problem}
Use the method of Laplace transforms to solve the given initial value problem.
\begin{eqnarray*}
x^{\prime} & = & y + \sin(t) \quad x(0)=2 \\
y^{\prime} & = & x + 2 \cos(t) \quad y(0) = 0 .
\end{eqnarray*}
\end{problem}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\LabSolutions


Theory and problems from: Nagel, Saff \& Sneider, \textit{Fundamentals of Differential Equations}, Eighth Edition, Adisson--Wesley.


\begin{preamble}
\begin{formulaitem}
 
\item The Laplace transform of a \textbf{periodic function} $f(x)$ with period $T$ is
\[\mathcal{L}\{f\}(s)=\frac{1}{1-e^{-Ts}}\int_{0}^{T}e^{-st}f(t)dt.\]

\item The \textbf{convolution} of $f(t)$ and $g(t)$, denoted $f*g$, is defined by
\[(f*g)(t)=\int_{0}^{t}f(t-v)g(v)dv.\]
The Laplace transform of the convolution is
\[\mathcal{L}\{f*g\}=F(s)G(s).\]

\item Brief \textbf{table of Laplace Transforms}.

% \begin{table}[ht]
\renewcommand{\arraystretch}{1.5}
\setlength{\tabcolsep}{10pt}
\begin{center}
\begin{tabular}{|ll|ll|}
\hline
$f(t)$ & $F(s)=\mathcal{L}\{f\}(s)$ & $f(t)$ & $F(s)=\mathcal{L}\{f\}(s)$ \\
\hline
$e^{at}f(t)$ & $F(s-a)$                                   &  $1$ & $\frac{1}{s}$ \\
$f'(t)$ & $sF(s)-f(0)$                                    &  $e^{at}$ & $\frac{1}{s-a} \qquad s>a$\\ 
$f''(t)$ & $s^{2}F(s)-sf(0)-f'(0)$                        &  $t^{n}$ & $\frac{n!}{s^{n+1}}$ \\
$t^{n}f(t)$ & $(-1)^{n}F^{(n)}(s)$                        &  $\sin bt$ & $\frac{b}{s^{2}+b^{2}}$ \\
$(f*g)(t)$ & $F(s)G(s)$                                   &  $\cos bt$ & $\frac{s}{s^{2}+b^{2}}$ \\
$u(t-a)$ & $\frac{e^{-as}}{s}$                            &  $e^{at}t^{n}$ & $\frac{n!}{(s-a)^{n+1}} \qquad s>a$ \\
$f(t-a)u(t-a)$ & $e^{-as}F(s)$                            &  $e^{at}\sin bt$ & $\frac{b}{(s-a)^{2}+b^{2}} \qquad s>a$ \\
$\delta(t-a)$ & $e^{-as}$                                 &  $e^{at}\cos bt$ & $\frac{s-a}{(s-a)^{2}+b^{2}} \qquad s>a$ \\
$\int_{0}^{s}f(\tau)d\tau$ & $\frac{1}{s}F(s)$            &  $\sinh bt$ & $\frac{b}{s^{2}-b^{2}}$ \\
$\frac{1}{t}f(t)$ & $\int_{s}^{\infty}F(\sigma)d\sigma$   &  $\cosh bt$ & $\frac{s}{s^{2}-b^{2}}$ \\
\hline 
\end{tabular}
\end{center}
% \caption{Brief table of Laplace Transforms.}
% \end{table}

\item The infinite sum of evenly shifted copies of $f(x)$ is
\[\mathcal{L}\left\{\sum _{n=0}^{\infty}(\pm1)^{k}f(t-ka)u(t-ka)\right\}(s)=\frac{1}{1\pm e^{as}}F(s).\]

\end{formulaitem}
\end{preamble}


\begin{problem}
Find the integral
\[\int_{0}^{\infty}t\sin (2t) e^{-2t}dt.\]
\end{problem}
\begin{solution}
Note that the integral is nothing but the Laplace transform evaluated at $s=2$
\[\int_{0}^{\infty}t\sin (2t) e^{-2t}dt = \mathcal{L}\{t\sin (2t)\}(2).\]
Recall also the derivative property 
\[tf(t)=(-1)F'(s).\]
Then 
\[\mathcal{L}\{t\sin (2t)\}(s)=-\left( \frac{2}{s^{2}+4} \right)'=4 \frac{s}{(s^{2}+4)^{2}},\]
and 
\[\boxed{\int_{0}^{\infty}t\sin (2t) e^{-2t}dt=4 \frac{2}{(4+4)^{2}}=\frac{1}{8}.}\]
\end{solution}


\begin{problem}
Find the Laplace transform of the periodic function
\[f(t)=\left\{\begin{array}{ll}
        e^{-t}\,, & 0<t<1\,,\\
        1\,, & 1<t<2\,,
       \end{array}\right.
\]
with period $T=2$.
\end{problem}
\begin{solution}
First we find the integral
\begin{equation*}\begin{split}
\int_{0}^{T}e^{-st}f(t)dt & = \int_{0}^{2}e^{-st}f(t)dt=\int_{0}^{1}e^{-st}e^{-t}dt + \int_{1}^{2}e^{-st}dt \\ &=-\frac{1}{s+1}\left( e^{-(s+1)} -1 \right) - \frac{1}{s}\left( e^{-2s} - e^{-s} \right).\end{split}
\end{equation*}
Thus,
\[\boxed{F(s) = \frac{1}{1-e^{-2s}}\left( \frac{1-e^{-(s+1)}}{s+1} + \frac{e^{-s}-e^{-2s}}{s} \right)}\].
\end{solution}



\begin{problem}
Use the convolution theorem to obtain to find the inverse Laplace transform of the given function
\begin{equation*}
F(s) = \dfrac{1}{s^2 (s^2+9)}.
\end{equation*}
\end{problem}
\begin{solution}
Taking the inverse Laplace transform and using the convolution property, we obtain:
\begin{eqnarray*}
f(t) & = & {\cal L}^{-1} \left\{ \dfrac{1}{s^2 (s^2+9)} \right\}(t) \\
& = & t * \dfrac{1}{3} \sin(3t) \\
& = &  \int_{0}^{t} (t-v)\dfrac{1}{3} \sin(3v) {\rm d} v \\
& = &  \dfrac{t}{3}\int_{0}^{t}\sin(3v) {\rm d} v  - \dfrac{1}{3}\int_{0}^{t}v\sin(3v) {\rm d} v \\
& = &  \dfrac{t}{3} \left[ -\dfrac{\cos(3v)}{3} \right]_{0}^{t}  - \dfrac{1}{3} \left[ -\dfrac{v \cos(3v)}{3} + \dfrac{\sin(3v)}{9} \right]_{0}^{t} \\
& = &  \dfrac{t}{3} \left[ \dfrac{1-\cos(3t)}{3}  \right]  - \dfrac{1}{3} \left[ -\dfrac{t \cos(3t)}{3} + \dfrac{\sin(3t)}{9} \right] \\
& = &  \dfrac{t}{9} - \dfrac{t\cos(3t)}{9}   +\dfrac{t \cos(3t)}{9} - \dfrac{\sin(3t)}{27}
\end{eqnarray*}
Thus,
\[\boxed{ f(t) = \dfrac{t}{9} - \dfrac{\sin(3t)}{27}}.\]
\end{solution}




\begin{problem}
Use the convolution theorem to obtain a formula for the solution to the given initial value problem, where $g(t)$ is piecewise continuous on $[0,\infty)$ and of exponential order.
\begin{equation*}
y^{\prime \prime} + 4y^{\prime} + 5 y = g(t), \quad y(0)=1, \quad y^{\prime}(0)=1.
\end{equation*}
\end{problem}
\begin{solution}
Applying a Laplace transform on both sides of this equation, we obtain:

\begin{equation*}
s^2 Y(s) -sy(0) - y^{\prime}(0) + 4(sY(s) - y(0))+5Y(s) = G(s)
\end{equation*}
Subbing in our initial conditions, we have:

\begin{equation*}
s^2 Y(s) -s - 1 + 4sY(s) -4 +5Y(s) = G(s)
\end{equation*}
Isolating $Y(s)$, we obtain:

\begin{eqnarray*}
Y(s) & = & \dfrac{G(s)}{s^2+4s+5} + \dfrac{s+5}{s^2+4s+5} \\
& = & \dfrac{G(s)}{(s+2)^2+1} + \dfrac{(s+2)+3}{(s+2)^2+1} \\
& = & \dfrac{G(s)}{(s+2)^2+1} + \dfrac{(s+2)}{(s+2)^2+1} + \dfrac{3}{(s+2)^2+1} \\
\end{eqnarray*}
Taking the inverse Laplace transform, we have:

\begin{eqnarray*}
y(t) & = & {\cal L}^{-1} \left\{ \dfrac{G(s)}{(s+2)^2+1} \right\}(t) + e^{-2t}\cos(t) + 3e^{-2t}\sin(t) \\
& = & (g(t) * e^{-2t}\sin(t))  + e^{-2t}\cos(t) + 3e^{-2t}\sin(t)
\end{eqnarray*}
Hence, 
\[ \boxed{ y(t) = \int_{0}^{t} g(t-v)e^{-2v}\sin(v) {\rm d} v  + e^{-2t}\cos(t) + 3e^{-2t}\sin(t) }. \]
\end{solution}



\begin{problem}
Solve the integro--differential equation
\[y'-2\int_{0}^{t}e^{t-v}y(v)dv=t,\quad y(0)=2.\]
\end{problem}
\begin{solution}
We can rewrite the integro--differential as
\[y'-2e^{t}*y=t,\]
and take Laplace transform to get (recall the convolution theorem here)
\[sY(s)-2-2\frac{1}{s-1}Y(s)=\frac{1}{s^{2}},\]
where
\[Y(s)=\frac{(2s^{2}+1)(s-1)}{s^{2}(s+1)(s-2)}=\frac{2s^{3}-2s^{2}+s-1}{s^{2}(s+1)(s-2)}=\frac{A}{s}+\frac{B}{s^{2}}+\frac{C}{s+1}+\frac{D}{s-2}.\]
Solving the partial fractions we get $A=-\frac{3}{4}$, $B=\frac{1}{2}$, $C=2$ and $D=\frac{3}{4}$.
Thus, we can take the inverse Laplace transforms right away to get
\[\boxed{y(t)=-\frac{3}{4}+\frac{1}{2}t+2e^{-t}+\frac{3}{4}e^{2t}}.\]
\end{solution}
\begin{solution}
We can rewrite the equation as
\[y'-2e^{t}\int_{0}^{t}e^{-v}y(v)dv=t,\]
take the derivative, and apply the product rule along with the fundamental theorem of calculus to get
\[y''-2e^{t}\int_{0}^{t}e^{-v}y(v)dv-2e^{t}e^{-t}y(t)=1.\]
Note that
\[-2e^{t}\int_{0}^{t}e^{-v}y(v)dv=t-y',\]
then we obtain the second order differential equation
\[y''-y'-2y=1-t,\]
with initial conditions (the second initial condition comes from evaluating the integro--differential equation at $t=0$)
\[y(0)=2,\quad y'(0)=0.\]
Apply Laplace transform we have
\[Y(s)=\frac{2s-2}{s^{2}-s-2}+\frac{1}{s(s^{2}-s-2)}-\frac{1}{s^{2}(s^{2}-s-2)}=\frac{2s^{3}-2s^{2}+s-1}{s^{2}(s+1)(s-2)},\]
which is the same partial fractions problem as before. Thus
\[\boxed{y(t)=-\frac{3}{4}+\frac{1}{2}t+2e^{-t}+\frac{3}{4}e^{2t}}.\]
\end{solution}


\begin{problem}
Use the method of Laplace transforms to solve the given initial value problem.
\begin{eqnarray*}
x^{\prime} & = & y + \sin(t) \quad x(0)=2 \\
y^{\prime} & = & x + 2 \cos(t) \quad y(0) = 0 .
\end{eqnarray*}
\end{problem}
\begin{solution}
Applying a Laplace transform to both these equations, we obtain
\begin{eqnarray*}
sX(s)-x(0) & = & Y(s) + \dfrac{1}{s^2+1}, \\
sY(s)-y(0) & = & X(s) + \dfrac{2s}{s^2+1}.
\end{eqnarray*}
Subbing in our initial conditions, we have
\begin{eqnarray*}
sX(s)-2 & = & Y(s) + \dfrac{1}{s^2+1}, \\
sY(s) & = & X(s) + \dfrac{2s}{s^2+1}.
\end{eqnarray*}
This is a system of equations with two unknown variables $X(s)$ and $Y(s)$. Isolate the variable that think is more convenient. In this case we isolate $X(s)$ in the second equation, to obtain
\begin{equation*}
X(s) = sY(s) -  \dfrac{2s}{s^2+1}.
\end{equation*}
Substituting this result into the first equation, we obtain:

\begin{eqnarray*}
s\left(sY(s) -  \dfrac{2s}{s^2+1}\right)-2 & = & Y(s) + \dfrac{1}{s^2+1} \\
\Rightarrow s^2Y(s) -  \dfrac{2s^2}{s^2+1}-2 & = & Y(s) + \dfrac{1}{s^2+1} \\
\Rightarrow (s^2-1)Y(s) & = & \dfrac{2s^2+1}{s^2+1} +2 \\
\Rightarrow (s^2-1)Y(s) & = & \dfrac{4s^2+3}{s^2+1}
\end{eqnarray*}
Recall that $\frac{1}{s^{2}+1}$ leads to $\sin t$, and $\frac{1}{s^{2}-1}$ leads to $\sinh t$. Isolating $Y(s)$, we obtain
\begin{align*}
Y(s) & =  \dfrac{4s^2+3}{(s^2+1)(s^{2}-1)} = \dfrac{As+B}{s^2+1}+ \dfrac{Cs+D}{s^{2}-1}.
\end{align*}
This is true for $B=\frac{1}{2}$, $D=\frac{7}{2}$, and $A=C=0$. Thus, 
\begin{equation*}
Y(s)  = \dfrac{1}{2} \dfrac{1}{s^2+1} + \dfrac{7}{2} \dfrac{1}{s^{2}-1} .
\end{equation*}
Now, we use our expression for $X(s)$,
\begin{align*}
X(s) &= sY(s) -  \dfrac{2s}{s^2+1}=\dfrac{1}{2} \dfrac{s}{s^2+1} + \dfrac{7}{2} \dfrac{s}{s^{2}-1} -  \dfrac{2s}{s^2+1}. 
\end{align*}
Thus, 
\[X(s) = -\dfrac{3}{2} \dfrac{s}{s^2+1} + \dfrac{7}{2} \dfrac{s}{s^{2}-1}.\]
Now, we take the inverse Laplace transform of $X(s)$ and $Y(s)$, to obtain
\begin{align*}
\Aboxed{x(t)&= -\frac{3}{2}\cos t +\frac{7}{2}\cosh t}, \\
\Aboxed{y(t)&= \frac{1}{2}\sin t +\frac{7}{2}\sinh t}.
\end{align*}
\end{solution}








\end{document}
